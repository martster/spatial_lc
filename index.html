<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      name="description"
      content="argolis is a spatial live coding tool to place and revisit Hydra visuals in AR."
    />
    <meta name="theme-color" content="#15181d" />
    <title>argolis | Living Archive</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <main class="app">
      <header class="topbar">
        <p class="topbar-kicker">Spatial Live Coding</p>
        <h1>argolis <span>living archive</span></h1>
        <p class="topbar-claim">
          Turn your room into a timeline of Hydra moments. Capture, place, and revisit visual states
          exactly where they happened.
        </p>
      </header>

      <section id="sync-panel" class="sync-panel" aria-label="Live sync session controls">
        <div id="share-session-details">
          <p id="role-chip" class="chip">Mode: Initializing</p>
          <p class="sync-help">
            Host edits code on laptop. Viewer opens the shared link on phone and places visuals in AR.
          </p>
          <div class="sync-row">
            <input id="room-id" type="text" placeholder="room id (e.g. berlin-01)" hidden />
            <button id="host-btn" type="button" hidden>Host Session</button>
            <button id="join-btn" type="button" hidden>Join as Viewer</button>
            <button id="copy-link-btn" type="button">Copy Viewer Link</button>
            <button id="qr-link-btn" type="button">Show QR</button>
          </div>
          <p id="sync-status" aria-live="polite">No remote session.</p>
        </div>
      </section>

      <section class="stage-wrapper" aria-label="Visual output stage">
        <canvas id="hydra-canvas"></canvas>
      </section>

      <section class="controls" aria-label="Live coding controls">
        <label for="hydra-code">Hydra Code</label>
        <p class="hydra-link-row">
          Need snippet ideas? <a href="https://hydra.ojack.xyz/" target="_blank" rel="noopener noreferrer">Browse Hydra Gallery</a>
        </p>
        <textarea id="hydra-code" spellcheck="false"></textarea>
        <div class="buttons">
          <button id="run-btn" type="button">Run</button>
          <button id="random-btn" type="button">Random</button>
          <button id="ar-btn" type="button">Start AR</button>
        </div>
        <p id="status" role="status" aria-live="polite"></p>
      </section>

      <section id="gallery-panel" class="gallery" aria-label="Placed visual gallery">
        <div class="gallery-head">
          <h2>Placed Panels</h2>
          <div class="gallery-head-actions">
            <button id="clear-gallery-btn" type="button">Clear Gallery</button>
          </div>
        </div>
        <p class="gallery-help">
          Each placement is a saved state (panel position + code at that time), not a video.
        </p>
        <div class="archive-filters">
          <div class="archive-window-buttons" role="group" aria-label="Filter archive by time">
            <button id="archive-window-all" type="button">All Time</button>
            <button id="archive-window-week" type="button">This Week</button>
            <button id="archive-window-today" type="button">Today</button>
          </div>
        </div>
        <div id="gallery-grid" class="gallery-grid"></div>
      </section>
    </main>
    <footer class="site-footer" aria-label="Legal and meta links">
      <p>(c) 2026 argolis</p>
      <nav class="site-footer-links" aria-label="Legal links">
        <a href="impressum.html">Impressum</a>
        <a href="datenschutz.html">Datenschutz</a>
      </nav>
    </footer>

    <div id="ar-overlay" class="ar-overlay" hidden>
      <button id="overlay-exit-btn" type="button">Exit AR</button>
      <button id="overlay-restage-latest-btn" type="button">Latest</button>
      <button id="overlay-undo-btn" type="button">Undo Last</button>
      <button id="overlay-clear-btn" type="button">Clear All</button>
      <p id="overlay-status" class="ar-overlay-status" aria-live="polite"></p>
    </div>

    <dialog id="qr-dialog" class="qr-dialog">
      <div class="qr-dialog-inner">
        <h3>Viewer QR</h3>
        <p>Scan with your phone camera to open the AR viewer.</p>
        <div id="qr-code"></div>
        <p id="qr-url"></p>
        <button id="qr-close-btn" type="button">Close</button>
      </div>
    </dialog>

    <script src="https://unpkg.com/peerjs@1.5.4/dist/peerjs.min.js"></script>
    <script src="https://unpkg.com/qrcodejs@1.0.0/qrcode.min.js"></script>
    <script src="https://unpkg.com/hydra-synth"></script>
    <script src="app.js" type="module"></script>
  </body>
</html>
